!function(){var e={391:function(e){var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),a=new D(n||[]);return i._invoke=function(e,t,r){var n=f;return function(o,i){if(n===v)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return N()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=C(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=v;var c=s(e,t,r);if("normal"===c.type){if(n=r.done?p:d,c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=p,r.method="throw",r.arg=c.arg)}}}(e,r,a),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",v="executing",p="completed",h={};function y(){}function m(){}function g(){}var S={};c(S,i,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(x([])));b&&b!==r&&n.call(b,i)&&(S=b);var k=g.prototype=y.prototype=Object.create(S);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function r(o,i,a,u){var c=s(e[o],e,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,u)}),(function(e){r("throw",e,a,u)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,u)}))}u(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function C(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,C(e,r),"throw"===r.method))return h;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=s(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function x(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:N}}function N(){return{value:t,done:!0}}return m.prototype=g,c(k,"constructor",g),c(g,"constructor",m),m.displayName=c(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},E(T.prototype),c(T.prototype,a,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(k),c(k,u,"Generator"),c(k,i,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=x,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:x(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},39:function(e,t,r){e.exports=r(391)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";function e(e,t,r,n,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}function t(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=t.apply(r,n);function u(t){e(a,o,i,u,c,"next",t)}function c(t){e(a,o,i,u,c,"throw",t)}u(void 0)}))}}var n=r(39),o=r.n(n);function i(e){return!e||!e.trim()}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f,d,v=function(){function e(){a(this,e)}var r,n;return c(e,null,[{key:"Sleep",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"WaitForCondition",value:(n=t(o().mark((function t(r,n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(new Date).getTime();case 2:return t.next=4,r();case 4:if(t.t0=!t.sent,!t.t0){t.next=7;break}t.t0=i+n>(new Date).getTime();case 7:if(!t.t0){t.next=12;break}return t.next=10,e.Sleep(100);case 10:t.next=2;break;case 12:return t.next=15,r();case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)})},{key:"WaitForSyncCondition",value:(r=t(o().mark((function t(r,n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(new Date).getTime();case 2:if(!(i+n>(new Date).getTime())){t.next=9;break}if(!r()){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,e.Sleep(100);case 7:t.next=2;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})},{key:"IsValidDataField",value:function(e){return null!=e&&e.length>0&&"null"!==e}},{key:"IsOnPage",value:function(t,r){if(e.IsValidDataField(t)){var n,o=t.toLowerCase().replace(/\s+/g,"").split(","),i=r.toLowerCase(),a=!1,u=l(o);try{for(u.s();!(n=u.n()).done;){var c=n.value;if(i.indexOf(c)>=0){a=!0;break}}}catch(e){u.e(e)}finally{u.f()}return a}return!1}}]),e}(),p=v;!function(e){e.GET_TRACKING_PAGE_DATA="GetTrackingPageData",e.INVALID_TRACKING_PAGE_ERROR="InvalidTrackingPageError",e.TRACKING_PAGE_DATA="TrackingPageData",e.TRACKING_PAGE_PARSING_ERROR="TrackingPageParsingError",e.TRACKING_PAGE_SCRIPT_ERROR="TrackingPageScriptError"}(f||(f={})),function(e){e.ORDERED="Ordered",e.SHIPPED="Shipped",e.DELIVERED="Delivered",e.RETURNED="Returned",e.CANCELED="Canceled",e.ERROR="Error"}(d||(d={}));function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function S(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function k(e,t,r){return k=b()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&y(o,r.prototype),o},k.apply(null,arguments)}function E(e){var t="function"==typeof Map?new Map:void 0;return E=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return k(e,arguments,w(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,e)},E(e)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return S(this,r)}}var C=function(e){m(r,e);var t=T(r);function r(e){var n;return a(this,r),n=t.call(this,e),Object.setPrototypeOf(h(n),r.prototype),n}return c(r)}(E(Error));function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var P=c((function e(){a(this,e),O(this,"transactionIdSelector",void 0),O(this,"purchaseTotalSelector",void 0),O(this,"numItemsSelector",void 0),O(this,"productDetailsData",void 0),O(this,"orderIdSelectors",void 0)})),D=c((function e(){a(this,e),O(this,"productIdSelector",void 0),O(this,"productPriceSelector",void 0),O(this,"productQuantitySelector",void 0)}));function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var R=function(){function e(){a(this,e),O(this,"domainName",void 0),O(this,"orderConfirmationPageUrl",void 0),O(this,"orderConfirmationRegex",void 0),O(this,"confirmationPageTelemetry",void 0),O(this,"orderDetailsPageUrl",void 0),O(this,"productNameSelector",void 0)}return c(e,null,[{key:"Create",value:function(t){var r=new e;return r.domainName=t.domainName,r.orderConfirmationPageUrl=t.orderConfirmationPageUrl,r.orderConfirmationRegex=t.orderConfirmationRegex,r.orderDetailsPageUrl=t.orderDetailsPageUrl,r.productNameSelector=t.productNameSelector,t&&t.confirmationPageTelemetry&&(r.confirmationPageTelemetry=this.CreateConfirmationPageTelemetryData(t.confirmationPageTelemetry)),r}},{key:"CreateConfirmationPageTelemetryData",value:function(e){var t=new P;return t.purchaseTotalSelector=e.purchaseTotalSelector,t.transactionIdSelector=e.transactionIdSelector,t.numItemsSelector=e.numItemsSelector,t.orderIdSelectors=e.orderIdSelectors,e&&e.productDetailsData&&(t.productDetailsData=this.CreateProductDetailsData(e.productDetailsData)),t}},{key:"CreateProductDetailsData",value:function(e){var t,r=[],n=x(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o){var i=new D;i.productIdSelector=o.productIdSelector,i.productPriceSelector=o.productPriceSelector,i.productQuantitySelector=o.productQuantitySelector,r.push(i)}}}catch(e){n.e(e)}finally{n.f()}return r}}]),e}(),I=c((function e(){a(this,e),O(this,"retailerData",void 0),O(this,"impressionId",void 0),O(this,"cashback",void 0)}));function A(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _=function(){function e(){a(this,e)}return c(e,null,[{key:"RunQuerySelectorAll",value:function(e){var t,r=e.split("<"),n=document.querySelectorAll(r[0]),o=A(r.slice(1));try{for(o.s();!(t=o.n()).done;){var i,a=t.value,u=null===(i=n[0])||void 0===i?void 0:i.shadowRoot;if(!u)return[];n=u.querySelectorAll(a)}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"GetElementsByClass",value:function(e){return e&&""!==e?document.getElementsByClassName(e):[]}},{key:"CreateRetailerData",value:function(e){if(e){var t=new I;return e.retailerData&&(t.retailerData=R.Create(e.retailerData)),e.impressionId&&(t.impressionId=e.impressionId),t}return new I}},{key:"CountMatchingElements",value:function(t){var r,n=0,o=A(t.split(";"));try{for(o.s();!(r=o.n()).done;){var i=r.value,a=e.CountVisibleElements(i);if(a>0){n=a;break}}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"isElementVisible",value:function(e){return e&&e.offsetWidth>0&&e.offsetHeight>0}},{key:"CountVisibleElements",value:function(t){var r,n=0,o=A(e.RunQuerySelectorAll(t));try{for(o.s();!(r=o.n()).done;){var i=r.value;e.isElementVisible(i)&&n++}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"GetDomainName",value:function(e){if(!e)return"";var t=e.toLowerCase().match(/(w){3}.?\./);return t&&null!=t.index&&t[0]?e.substring(t.index+t[0].length):e}},{key:"inIframe",value:function(){try{return window.self!==window.top}catch(e){return!0}}},{key:"GetFirstVisibleElement",value:function(t){var r,n=A(e.RunQuerySelectorAll(t));try{for(n.s();!(r=n.n()).done;){var o=r.value;if(e.isElementVisible(o))return o}}catch(e){n.e(e)}finally{n.f()}}},{key:"GetBoxValue",value:function(t){if(p.IsValidDataField(t))try{var r=e.GetTextValue(t);return r?r.trim():r}catch(e){throw Error(e.message)}return""}},{key:"getHrefFromHtmlElement",value:function(e){return e?e.getAttribute("href"):""}},{key:"getTextContentFromHtmlElement",value:function(e){if(!e)return"";var t=e.textContent||e.innerText;return t?t.trim():""}},{key:"GetTextValue",value:function(t){var r=t.split(";"),n=e.GetFirstVisibleElement(r[0]),o=n;if(void 0===o)return"";var i=o.innerText;if(1===r.length)i=(o=e.NormalizeIfSuperscripted(n)).innerText;else{var a=e.GetFirstVisibleElement(r[1]);if(a&&a.innerText){var u="."+a.innerText;if(o.contains(a)){var c=o.cloneNode(!0);c.childNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&c.removeChild(e)})),i=null!=c&&c.innerText?c.innerText:i}i+=u}}return e.StripInvalidJSONCharacters(i)}},{key:"StripInvalidJSONCharacters",value:function(e){return e.replace(/\n/gi,"")}},{key:"NormalizeIfSuperscripted",value:function(e){if(e&&e.innerHTML&&e.innerHTML.toLowerCase().indexOf("</sup>")>-1)try{for(var t=e.cloneNode(!0),r=t.childNodes.length,n=0;n<r;n++){var o=t.childNodes[n];if("SUP"===o.tagName){var i=o.innerText,a=/[0-9\.]+/g.exec(i);if(null!==a)return i="."+a[0],o.innerText=i,t}}}catch(t){return e}return e}},{key:"getOrderStatusFromTextInput",value:function(e){if(!e)return d.ERROR;var t=e.toLowerCase();return t.includes("delivered")?d.DELIVERED:t.includes("arriv")||t.includes("ship")?d.SHIPPED:t.includes("return")?d.RETURNED:t.includes("cancel")?d.CANCELED:d.ORDERED}},{key:"isExpiredDeliveryDate",value:function(e){if(e&&e.toLowerCase().includes("cancel"))return!0;if(!e||isNaN(Date.parse(e)))return!1;var t=e.match(/\d{4}$/g);null!=t&&0!==t.length||(e+=" "+(new Date).getFullYear());var r=new Date(Date.parse(e));return(Date.now()-r.getTime())/864e5>2}},{key:"getOrderDetailsPageForSpecialWebsites",value:function(e,t){return"walmart.com"===e.domainName?"".concat(e.domainName,"/orders/").concat(t):""}},{key:"getOrderNumberForSpecialWebsites",value:function(e,t){if("walmart.com"===e){var r=t.match(/(?<=Order#\s\s*)[\s\S]*?(?=\s*(\|\sTotal))/g);return null!=r&&r.length>0?r[0]:t}return t.startsWith("#")?t.substring(1).trim():t}},{key:"getTotalCostForSpecialWebsites",value:function(e,t){if("walmart.com"===e){var r=t.match(/(?<=Total\s\$\s*)[\s\S]*/g);return null!=r&&r.length>0?r[0]:t}return t}}]),e}(),G=c((function e(){a(this,e),O(this,"orderDate",void 0),O(this,"totalCost",void 0),O(this,"orderNumber",void 0),O(this,"orderDetailsPage",void 0),O(this,"listOfProducts",void 0),O(this,"orderStatus",void 0),O(this,"orderSummary",void 0),O(this,"trackPackageButtonSelector",void 0)})),j=function(){function e(){a(this,e),O(this,"email",void 0),O(this,"orderNumber",void 0),O(this,"phoneNumber",void 0),O(this,"trackingUrl",void 0)}return c(e,null,[{key:"create",value:function(t){var r=new e;return t&&(r.email=t.email,r.orderNumber=t.orderNumber,r.phoneNumber=t.phoneNumber,r.trackingUrl=t.trackingUrl),r}}]),e}(),F=function(){function e(){a(this,e),O(this,"productImageSelector",void 0),O(this,"productUrlSelector",void 0)}return c(e,null,[{key:"create",value:function(t){var r=new e;return t&&(r.productImageSelector=t.productImageSelector,r.productUrlSelector=t.productUrlSelector),r}}]),e}(),U=function(){function e(){a(this,e),O(this,"trackPackageButtonSelector",void 0),O(this,"orderSummarySelector",void 0),O(this,"productContainerSelector",void 0),O(this,"productContentSelector",void 0)}return c(e,null,[{key:"create",value:function(t){var r=new e;if(t){r.trackPackageButtonSelector=t.trackPackageButtonSelector,r.orderSummarySelector=t.orderSummarySelector,r.productContainerSelector=t.productContainerSelector;var n=t.productContentSelector;n&&(r.productContentSelector=F.create(n))}return r}}]),e}(),H=function(){function e(){a(this,e),O(this,"orderDateSelector",void 0),O(this,"totalCostSelector",void 0),O(this,"orderNumberSelector",void 0),O(this,"orderDetailsPageSelector",void 0),O(this,"shipmentContainerSelector",void 0),O(this,"shipmentContentSelector",void 0)}return c(e,null,[{key:"create",value:function(t){var r=new e;if(t){r.orderDateSelector=t.orderDateSelector,r.totalCostSelector=t.totalCostSelector,r.orderNumberSelector=t.orderNumberSelector,r.orderDetailsPageSelector=t.orderDetailsPageSelector,r.shipmentContainerSelector=t.shipmentContainerSelector;var n=t.shipmentContentSelector;n&&(r.shipmentContentSelector=U.create(n))}return r}}]),e}(),M=function(){function e(){a(this,e),O(this,"trackingUrl",void 0),O(this,"clickToOpenOrderSelector",void 0),O(this,"orderContainerSelector",void 0),O(this,"orderContentSelector",void 0)}return c(e,null,[{key:"create",value:function(t){var r=new e;if(t){r.trackingUrl=t.trackingUrl,r.clickToOpenOrderSelector=t.clickToOpenOrderSelector,r.orderContainerSelector=t.orderContainerSelector;var n=t.orderContentSelector;n&&(r.orderContentSelector=H.create(n))}return r}}]),e}(),V=function(){function e(){a(this,e),O(this,"impressionId",void 0),O(this,"domainName",void 0),O(this,"packageTrackingSelectors",void 0)}return c(e,null,[{key:"create",value:function(t){var r=new e;if(t){r.impressionId=t.impressionId,r.domainName=t.domainName;var n=t.packageTrackingSelectors;n&&(r.packageTrackingSelectors=n.map((function(e){return M.create(e)})))}return r}}]),e}(),B=c((function e(){a(this,e),O(this,"productImageUrl",void 0),O(this,"productName",void 0),O(this,"productUrl",void 0)}));function J(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=J(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},q.apply(this,arguments)}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return S(this,r)}}var W=function(e){m(r,e);var t=K(r);function r(){return a(this,r),t.apply(this,arguments)}return c(r,[{key:"getMessageType",value:function(){return f.GET_TRACKING_PAGE_DATA.toString()}},{key:"raiseMessageFromHost",value:function(e){var t=e.shift();if(t&&t===this.getMessageType())try{"interactive"===document.readyState||"complete"===document.readyState?window.getTrackingPageData(e):window.addEventListener&&window.addEventListener("DOMContentLoaded",(function(t){window.checkAndGetTrackingPageData(e)}))}catch(e){}}},{key:"postMessageToHost",value:function(e,t){q(w(r.prototype),"postMessageToHost",this).call(this,e,t,trackingPageValidatorNativeHandler)}}]),r}(function(){function e(){a(this,e)}return c(e,[{key:"raiseMessageFromHost",value:function(e,t,r){var n=e.shift();if(n&&n===this.getMessageType())try{"interactive"===document.readyState||"complete"===document.readyState?t(e,!0):window.addEventListener&&window.addEventListener("DOMContentLoaded",(function(t){r(e,!0)}))}catch(e){}}},{key:"postMessageToHost",value:function(e,t,r){try{r&&r.sendMessageToHost(e,t)}catch(e){}}},{key:"initialize",value:function(e,t,r){e.splice(0,2);try{"interactive"===document.readyState||"complete"===document.readyState?t(e,!1):window.addEventListener&&window.addEventListener("DOMContentLoaded",(function(t){r(e,!1)}))}catch(e){return!1}return!0}}]),e}());function Q(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var z="",Y=!1,X="";function Z(e){return ee.apply(this,arguments)}function ee(){return(ee=t(o().mark((function e(r){var n,a,u,c,l,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.prev=1,z=r[2],Y="true"===r[3].toLowerCase(),X="",u=JSON.parse(r[0]),c=V.create(u),l=JSON.parse(r[1]),s=l?l.filter((function(e){var t;return!i(null!==(t=null==e?void 0:e.orderNumber)&&void 0!==t?t:"")})).map((function(e){return j.create(e)})):[],n=null!==(a=null==c?void 0:c.impressionId)&&void 0!==a?a:"",e.next=12,p.WaitForCondition(t(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(c));case 1:case"end":return e.stop()}}),e)}))),5e3).then((function(e){e?ie(n,c,s):oe(n,new C("Invalid page"),c,s)})).catch((function(e){oe(n,e,c,s)}));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),oe(n,e.t0,null,null);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}function te(e){var t=null==e?void 0:e.packageTrackingSelectors;if(!t)return!1;var r,n=window.location.href.toString(),o=!1,i="",a=Q(t);try{for(a.s();!(r=a.n()).done;){var u=r.value;if(u.trackingUrl&&n.includes(u.trackingUrl)&&u.orderContainerSelector){o=!0,i=u.orderContainerSelector;break}}}catch(e){a.e(e)}finally{a.f()}return!!o&&!!document.querySelector(i)}function re(e){return!Y||!i(e)&&(i(X)?(X=e,!0):X===e)}function ne(e,t){var r,n=_.getTextContentFromHtmlElement(e);return i(n)?null!==(r=null==t?void 0:t.getAttribute("alt"))&&void 0!==r?r:"":n}function oe(e,t,r,n){var o,i=f.TRACKING_PAGE_SCRIPT_ERROR,a=null!==(o=null==t?void 0:t.message)&&void 0!==o?o:"";t instanceof SyntaxError?i=f.TRACKING_PAGE_PARSING_ERROR:t instanceof C&&(i=f.INVALID_TRACKING_PAGE_ERROR),function(e,t,r,n,o){var i={domain:_.GetDomainName(window.location.hostname),listOfOrderTrackingDetails:JSON.stringify(o),pageUrl:window.location.toString(),retailerData:JSON.stringify(n)};ue(ae(e,t,r,i))}(e,i,a,r,n),window.trackingPageValidatorRuntime.postMessageToHost(i,[a,z])}function ie(e,t,r){var n=new Set;null!=r&&r.length&&(n=new Set(r.map((function(e){return e.orderNumber}))));var o=function(e,t){var r=[],n=null==e?void 0:e.packageTrackingSelectors;if(!n)return r;var o,a=Q(n);try{for(a.s();!(o=a.n()).done;){var u,c,l=o.value,s=null!==(u=null==l?void 0:l.clickToOpenOrderSelector)&&void 0!==u?u:"";if(!i(s))for(var f=_.RunQuerySelectorAll(s),d=1;d<f.length;d++)f[d].click();var v,p=null!==(c=null==l?void 0:l.orderContainerSelector)&&void 0!==c?c:"",h=Q(_.RunQuerySelectorAll(p));try{for(h.s();!(v=h.n()).done;){var y,m,g,S,w,b,k=v.value,E=null==l||null===(y=l.orderContentSelector)||void 0===y?void 0:y.shipmentContainerSelector;if(E){var T=null!==(m=null==l||null===(g=l.orderContentSelector)||void 0===g?void 0:g.orderNumberSelector)&&void 0!==m?m:"",C=k.querySelector(T),O=_.getTextContentFromHtmlElement(C),P=_.getOrderNumberForSpecialWebsites(null==e?void 0:e.domainName,O);if(!((null==t?void 0:t.size)>0)||null!=t&&t.has(P)){var D=null==l||null===(S=l.orderContentSelector)||void 0===S?void 0:S.orderDateSelector,x=D?k.querySelector(D):null,N=_.getTextContentFromHtmlElement(x);if(re(N)){var R,I=null==l||null===(w=l.orderContentSelector)||void 0===w?void 0:w.totalCostSelector,A=I?k.querySelector(I):null,L=_.getTextContentFromHtmlElement(A),j=_.getTotalCostForSpecialWebsites(null==e?void 0:e.domainName,L),F=null==l||null===(b=l.orderContentSelector)||void 0===b?void 0:b.orderDetailsPageSelector,U=F?k.querySelector(F):null,H=U?_.getHrefFromHtmlElement(U):_.getOrderDetailsPageForSpecialWebsites(e,P),M=Q(k.querySelectorAll(E));try{for(M.s();!(R=M.n()).done;){var V,J,q,K=R.value,W=[],$=null==l||null===(V=l.orderContentSelector)||void 0===V?void 0:V.shipmentContentSelector,z=null!==(J=null==$?void 0:$.trackPackageButtonSelector)&&void 0!==J?J:"",Y=null==$?void 0:$.orderSummarySelector,X=null!==(q=null==$?void 0:$.productContainerSelector)&&void 0!==q?q:"",Z=Y?K.querySelector(Y):null,ee=_.getTextContentFromHtmlElement(Z),te=_.getOrderStatusFromTextInput(ee);if(!_.isExpiredDeliveryDate(ee)){var oe,ie=Q(K.querySelectorAll(X));try{for(ie.s();!(oe=ie.n()).done;){var ae,ue=oe.value,ce=null==$?void 0:$.productContentSelector,le=null==ce?void 0:ce.productImageSelector,se=null==ce?void 0:ce.productUrlSelector,fe=le?ue.querySelector(le):null,de=null!==(ae=null==fe?void 0:fe.src)&&void 0!==ae?ae:"",ve=se?ue.querySelector(se):null,pe=ne(ve,fe);if(!i(de)||!i(pe)){var he=Object.assign(new B,{productImageUrl:de,productName:pe,productUrl:_.getHrefFromHtmlElement(ve)});W.push(he)}}}catch(e){ie.e(e)}finally{ie.f()}if(null!=W&&W.length){var ye=Object.assign(new G,{listOfProducts:W,orderDate:N,orderDetailsPage:H,orderNumber:P,orderStatus:te,orderSummary:ee,totalCost:j,trackPackageButtonSelector:z});r.push(ye)}}}}catch(e){M.e(e)}finally{M.f()}}}}}}catch(e){h.e(e)}finally{h.f()}}}catch(e){a.e(e)}finally{a.f()}return r}(t,n);window.trackingPageValidatorRuntime.postMessageToHost(f.TRACKING_PAGE_DATA,[JSON.stringify(o),z]),function(e,t,r,n){var o={domain:_.GetDomainName(window.location.hostname),listOfOrderTrackingDetails:JSON.stringify(n),orders:JSON.stringify(r)};ue(ae(e,f.TRACKING_PAGE_DATA,t,o))}(e,"Successful order history page extraction",o,r)}function ae(e,t,r,n){var o={};return o.JsonData=JSON.stringify(n),o.EventType=t,o.LogLevel="Information",o.Message=r,o.ClientContext={AppInfoClientName:"Edge",JSVersion:"1.1"},e&&(o.ImpressionId=e),o}function ue(e){var t=[JSON.stringify(e)];window.trackingPageValidatorRuntime.postMessageToHost("LogScriptTelemetry",t)}window.checkAndGetTrackingPageData=function(e){_.inIframe()||Z(e)},window.getTrackingPageData=Z;var ce=new W;window.trackingPageValidatorRuntime=ce}()}();